$(document).ready(function(){function o(){if(i&&$("#usr").val()!=""&&$("#comment").val()!=""){f("Checking connection, trying to add your post.");var t={};t.person=$("#usr").val();t.message=$("#comment").val();n.server.addPost(JSON.stringify(t));$("#comment").val("")}}function u(){$("#message").attr("class","greenmessage");$("#message").html("Connected, checking for new messages");$("#btnPost").removeAttr("disabled");$("#btnPost").html("Post")}function f(n){$("#message").attr("class","redmessage");$("#message").html(n);$("#btnPost").attr("disabled","disabled")}function s(){$("#usr")[0].value=e("MyCookie");e("nc")=="true"&&$("#chkMessages").prop("checked",!0)}function e(n){for(var t,r=n+"=",u=document.cookie.split(";"),i=0;i<u.length;i++){for(t=u[i];t.charAt(0)==" ";)t=t.substring(1);if(t.indexOf(r)==0)return t.substring(r.length,t.length)}return""}var i=!1,n,t,r;$("#btnPost").attr("disabled","disabled");n=$.connection.nbeHub;t=0;s();$.connection.hub.start(function(){u();i=!0;t=0;r=!0;n.server.getAllPosts()});$.connection.hub.disconnected(function(){i=!1;t++;setTimeout(function(){f("Attempting Reconnect: Attempt:"+t);t>3&&alert("Having problems connecting. I suggest refreshing your browser, Mark");$.connection.hub.start()},3e3)});n.client.newPost=function(n){var t=JSON.parse(n),i,u,f,e;$("#posts").html("");i=0;for(u in t)f=$("<span/>").html(t[u].Person).text(),e=$("<span/>").html(t[u].Message).text(),t[u].Person==$("#usr").val()?$("#postTemplate").clone().attr("id","ptc"+i).attr("class","panel panel-danger").appendTo("#posts"):$("#postTemplate").clone().attr("id","ptc"+i).appendTo("#posts"),t[u].FormattedDate==undefined?$("#ptc"+i).children("#person").html(f+" &nbsp;&nbsp;&nbsp;&nbsp;("+t[u].PostTime.substring(0,16)+")"):$("#ptc"+i).children("#person").html(f+" &nbsp;&nbsp;&nbsp;&nbsp;("+t[u].FormattedDate+")"),$("#ptc"+i).children("#message").html(e),i++;navigator.userAgent.toLowerCase().indexOf("chrome")>-1&&!r&&$("#chkMessages").prop("checked")&&alert("new message has been posted on NBE");r=!1};n.client.postSuccessful=function(){u()};$("#btnPost").click(function(){o()});$("textarea").focus(function(){$(this).select()});$("#usr").keyup(function(){var n=new Date,t;n.setDate(n.getDate()+3e3);t=escape($("#usr")[0].value)+"; expires="+n.toUTCString();document.cookie="MyCookie="+t});$("#chkMessages").change(function(){var n=new Date,t;n.setDate(n.getDate()+3e3);t=escape($("#chkMessages").prop("checked"))+"; expires="+n.toUTCString();document.cookie="nc="+t});$("#chkMessages").click(function(){$("#chkMessages").prop("checked")&&alert("This only works for Google Chrome on a desktop computer. If you tick the box then leave the browser running in the background you should get a visual cue when new posts are added. There's no point to ticking it on a mobile phone or tablet as browsers go to sleep in those environments. Try it to see if it works for you, if not, untick the box.  \n\n Mark.")})});
//# sourceMappingURL=App.min.js.map
